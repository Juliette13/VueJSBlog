<!DOCTYPE html>
<html lang="fr" xmlns:v-bind="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog JPvl</title>
    <meta name="Description" content="Un blog VueJS Qu'il est bien !">
    <link rel="icon" type="image/x-icon" href="images/favicon.png" />
    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Montserrat:400,500">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/material.min.css" />
    <link rel="stylesheet" href="css/mdl-selectfield.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css" />
    <link rel="stylesheet" href="css/animate.min.css" />
    <link rel="stylesheet" href="css/magnific-popup.css" />
    <link rel="stylesheet" href="css/flexslider.css" />
    <link rel="stylesheet" href="css/style.css">
    <script src="js/vue.min.js"></script>
</head>
<body>
<div id="vue-app">
    <header id="header">
        <div id="hdr-wrapper">
            <div class="layer-stretch hdr">
                <div class="tbl">
                    <div class="tbl-row">
                        <!-- Start Header Logo Section -->
                        <div class="tbl-cell hdr-logo">
                            <a href="index.html"><img src="images/logo.png" alt=""></a>
                        </div><!-- End Header Logo Section -->
                        <div class="tbl-cell hdr-menu">
                            <!-- Start Menu Section -->
                            <ul class="menu">
                                <li class="menu-megamenu-li">
                                    <a id="menu-doctor" class="mdl-button mdl-js-button mdl-js-ripple-effect">Articles <i class="fa fa-chevron-down"></i></a>
                                    <ul class="menu-megamenu">
                                        <li class="row">
                                            <div class="col-lg-6">
                                                <button class="button-icon button-icon-blue m-1" @click="display('articles')"><span>Tous les articles</span> <i class="fa fa-arrow-right"></i> </button>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="megamenu-ttl">Derniers articles</div>
                                                <ul>
                                                    <li v-for="recentArticle in recentArticles"><a @click="selectArticle(recentArticle)">{{ recentArticle.title }}</a></li>
                                                </ul>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li v-if="userConnected">
                                    <a id="menu-profile" class="mdl-button mdl-js-button mdl-js-ripple-effect">Mon Compte <i class="fa fa-chevron-down"></i></a>
                                    <ul class="menu-dropdown">
                                        <li><a @click="display('editer mon profil')">Editer mon profil</a></li>
                                        <li><a @click="display('editer les articles')">Editer les articles</a></li>
                                        <li><a @click="userLogout">Déconnexion</a></li>
                                    </ul>
                                </li>
                                <li v-if="!userConnected"><a class="mdl-button mdl-js-button mdl-js-ripple-effect" @click="display('connexion')">Connexion</a></li>
                                <li v-if="!userConnected"><a class="mdl-button mdl-js-button mdl-js-ripple-effect" @click="display('enregistrer')">S'enregistrer</a></li>
                                <li>
                                </li>
                                <li class="mobile-menu-close"><i class="fa fa-times"></i></li>
                            </ul><!-- End Menu Section -->
                            <div id="menu-bar"><a><i class="fa fa-bars"></i></a></div>
                        </div>
                    </div>
                </div>
            </div>
        </div><!-- End Main Header Section -->
    </header><!-- End Header -->

    <div class="page-ttl">
        <div class="layer-stretch">
            <div class="page-ttl-container">
                <h1 style="text-transform: capitalize;">{{ displayBlock }}</h1>
            </div>
        </div>

    </div><!-- End Page Title Section -->

    <div v-for="alert in alerts">
        <div v-bind:class="alert.type" class="alert" role="alert">
            <strong v-if="alert.type === 'alert-success'">Succes</strong>
            <strong v-if="alert.type === 'alert-danger'">Erreur</strong>
            {{ alert.content }}
            <button class="close" type="button" data-dismiss="alert">×</button>
        </div>
    </div>

    <div class="layer-stretch" v-if="displayBlock === 'enregistrer'">
        <div class="layer-wrapper">
            <div class="form-container">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label form-input-icon">
                    <i class="fa fa-user-o"></i>
                    <input class="mdl-textfield__input" type="text" pattern="[A-Z,a-z, ]*" id="register-name" v-model="form_register_login" placeholder="Identifiant" title="identifiant">
                    <span class="mdl-textfield__error">Un identifiant valide!</span>
                </div>
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label form-input-icon">
                    <i class="fa fa-user"></i>
                    <input class="mdl-textfield__input" type="text" pattern="[A-Z,a-z, ]*" id="register-email" v-model="form_register_name" placeholder="Nom" title="nom">
                    <span class="mdl-textfield__error">Entrez un nom valide!</span>
                </div>
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label form-input-icon">
                    <i class="fa fa-user"></i>
                    <input class="mdl-textfield__input" type="text" pattern="[A-Z,a-z, ]*" id="register-firstname" v-model="form_register_firstname" placeholder="Prénom" title="prenom">
                    <span class="mdl-textfield__error">Entrez un prénom valide!</span>
                </div>
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label form-input-icon">
                    <i class="fa fa-user"></i>
                    <input class="mdl-textfield__input" type="text" pattern="[A-Z,a-z, ]*" id="register-addres" v-model="form_register_addres" placeholder="Adresse" title="adresse">
                    <span class="mdl-textfield__error">Entrez une adresse valide!</span>
                </div>
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label form-input-icon">
                    <i class="fa fa-key"></i>
                    <input class="mdl-textfield__input" type="password" id="register-password" v-model="form_register_password" placeholder="Mot de passe" title="password">
                    <span class="mdl-textfield__error">6 caractères minimum!</span>
                </div>
                <div class="form-submit">
                    <button class="mdl-button mdl-js-button mdl-js-ripple-effect button button-primary" @click="userRegister()">Créer mon compte</button>
                </div>
                <div class="login-link">
                    <span class="paragraph-small">Vous avez déjà un compte?</span>
                    <a @click="displayBlock('connexion')" class="">Se connecter</a>
                </div>
            </div>

        </div>
    </div>

    <div id="login-page" class="layer-stretch" v-if="displayBlock === 'connexion'">
        <div class="layer-wrapper">
            <div class="form-container">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label form-input-icon">
                    <i class="fa fa-envelope-o"></i>
                    <input class="mdl-textfield__input" type="text" v-model="form_login_login" title="login" placeholder="Login">
                </div>
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label form-input-icon">
                    <i class="fa fa-key"></i>
                    <input class="mdl-textfield__input" type="password" v-model="form_login_password" title="password" placeholder="Mot de passe">
                </div>
                <div class="form-submit">
                    <button class="mdl-button mdl-js-button mdl-js-ripple-effect button button-primary" @click="userLogin">Connexion</button>
                </div>
                <div class="login-link">
                    <span class="paragraph-small">Vous n'avez pas de compte ?</span>
                    <a @click="display('enregistrer')" class="">S'enregistrer comme nouvel utilisateur</a>
                </div>
            </div>
        </div>
    </div>

    <div id="doctor-page" class="layer-stretch" v-if="displayBlock === 'editer mon profil'">
        <div class="layer-wrapper layer-bottom-10">
            <div class="theme-material-card">
                <div class="row">
                    <div class="col-sm-4">
                        <div class="theme-img theme-img-scalerotate">
                            <img src="uploads/doctor-1.jpg" alt="">
                        </div>
                    </div>
                    <div class="col-sm-8">
                        <div class="doctorp-name">
                            <h3>{{ user.name }} {{ user.firstName }}</h3>
                        </div>
                        <p class="text-muted p-2">{{ user.addres }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div v-if="displayBlock === 'editer les articles'">
        <div class="theme-material-card">
            <table class="table table-striped">
                <thead>
                <tr>
                    <th>Titre</th>
                    <th class="text-center">Publication</th>
                    <th class="text-center">Action</th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="article in articles">
                    <td>{{ article.title }}</td>
                    <td class="text-center">{{ dateToStr(article.datePost) }}</td>
                    <td class="text-center">
                        <a href="#" data-toggle="tooltip" data-placement="top" title="Edit"><i class="fa fa-pencil color-dark"></i></a>
                        <a href="#" data-toggle="tooltip" data-placement="top" title="Delete" @click="deleteArticle(article)"><i class="fa fa-close font-16 color-red m-l-10"></i></a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <!-- Start Blog List Section -->
    <div class="layer-stretch" v-if="displayBlock === 'articles'">
        <div class="layer-wrapper">
            <div class="row">
                <div class="col-lg-8 text-center">
                    <div class="theme-material-card blog-full-block" v-for="article in filteredArticles">
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="blog-full-date">{{ article.datePost }}</div>
                                <div class="theme-img theme-img-scalerotate">
                                    <img v-bind:src="'data:image/jpeg;base64,' + article.picture" alt="">
                                </div>
                            </div>
                            <div class="col-sm-8">
                                <div class="blog-full-ttl">
                                    <h3><a @click="selectArticle(article)">{{ article.title }}</a></h3>
                                </div>
                                <div class="blog-full-description" v-if="article.contains.length>80">{{ article.contains.substring(0,80) }} [...]</div>
                                <div class="blog-full-description" v-else>{{ article.contains }}</div>
                                <div class="blog-full-ftr">
                                    <a class="pull-left blog-full-author"><i class="fa fa-user"></i>{{ article.author }}</a>
                                    <a class="pull-right anchor-icon" @click="selectArticle(article)">
                                        En lire plus ... <i class="fa fa-arrow-right"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <ul class="theme-pagination" >
                        <li v-for="i in nbPage()">
                            <a v-if="activePage === i" href="#" class="active">{{ i }}</a>
                            <a v-else href="#" @click="setPageActive(i)">{{ i }}</a>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-4">
                    <div class="theme-material-card text-center">
                        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label form-input">
                            <input class="mdl-textfield__input" type="text" id="sidebar-search" v-model="searchString" placeholder="Rechercher...">
                        </div>
                    </div>
                    <div class="theme-material-card">
                        <div class="sub-ttl">Recent Post</div>
                        <a href="#" class="row blog-recent" v-for="recentArticle in recentArticles">
                            <div class="col-4 blog-recent-img">
                                <img class="img-responsive img-thumbnail" v-bind:src="'data:image/jpeg;base64,' + recentArticle.picture" alt="">
                            </div>
                            <div class="col-8 blog-recent-post">
                                <h4>{{ recentArticle.title }}</h4>
                                <p>{{ dateToStr(recentArticle.datePost) }}</p>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- End Blog List Section -->

    <div class="layer-stretch" v-if="displayBlock === 'article'">
        <div class="layer-wrapper">
            <div class="row">
                <div class="text-center">
                    <div class="sidebar">
                        <div class="theme-img theme-img-scalerotate blog-picture">
                            <img class="" v-bind:src="'data:image/jpeg;base64,' + article.picture" alt="">
                        </div>
                        <h2 class="blog-ttl">{{ article.title }}</h2>
                        <ul class="blog-detail">
                            <li><i class="fa fa-user-o"></i>{{ article.author }}</li>
                            <li><i class="fa fa-calendar-o"></i>{{ dateToStr(article.datePost) }}</li>
                        </ul>
                        <div class="blog-post">
                            <p class="paragraph-medium paragraph-black">{{ article.contains }}</p>
                        </div>
                        <div class="row blog-meta">
                            <div class="col-sm-7 blog-tag">
                                <p>Categorie : </p>
                                <ul>
                                    <li><a>{{ article.category }}</a></li>
                                </ul>
                            </div>
                            <div class="col-sm-5 text-right">
                                <ul class="social-list social-list-sm">
                                    <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                                    <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                                    <li><a href="#"><i class="fa fa-google"></i></a></li>
                                    <li><a href="#"><i class="fa fa-instagram"></i></a></li>
                                    <li><a href="#"><i class="fa fa-linkedin"></i></a></li>
                                    <li><a href="#"><i class="fa fa-flickr"></i></a></li>
                                    <li><a href="#"><i class="fa fa-rss"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="sidebar">
                        <div class="sub-ttl layer-ttl-white">Comments</div>
                        <ul class="comment-list">
                            <li v-for="comment in comments">
                                <div v-if="comment.id_article === article.id_article">
                                    <div class="row">
                                        <div class="col-2 hidden-xs-down pr-0 comment-img">
                                            <div class="theme-img">
                                                <img v-bind:src="getPictureByUserId(comment.id_author)" >
                                            </div>
                                        </div>
                                        <div class="col-10 comment-detail text-left">
                                            <div class="comment-meta">
                                                <span>{{ comment.name_author }}</span>
                                                <span>{{ comment.dateComment }}</span>
                                            </div>
                                            <div class="comment-post">
                                                {{ comment.contains }}
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </li>
                        </ul>

                        <div class="sub-ttl">Poster un commentaire</div>
                        <div class="row comment-form">
                            <div class="col-sm-12">
                                <div class="mdl-textfield mdl-js-textfield form-input">
                                    <textarea class="mdl-textfield__input" rows="4" id="comment-message" v-model="form_commentaire_text" title="commentaire"></textarea>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="form-submit">
                                    <button class="mdl-button mdl-js-button mdl-js-ripple-effect button button-primary" @click="submitComment(article)">
                                        Publier
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer id="footer">
        <div class="layer-stretch">
            <!-- Start main Footer Section -->
            <div class="row layer-wrapper">
                <div class="col-md-6 footer-block">
                    <div class="footer-ttl"><p>Basic Info</p></div>
                    <div class="footer-container footer-a">
                        <div class="tbl">
                            <div class="tbl-row">
                                <div class="tbl-cell"><i class="fa fa-map-marker"></i></div>
                                <div class="tbl-cell">
                                    <p class="paragraph-medium paragraph-white">
                                        Your office, Building Name<br />
                                        Street name, Area<br />
                                        City, Country Pin Code
                                    </p>
                                </div>
                            </div>
                            <div class="tbl-row">
                                <div class="tbl-cell"><i class="fa fa-phone"></i></div>
                                <div class="tbl-cell">
                                    <p class="paragraph-medium paragraph-white">11122333333</p>
                                </div>
                            </div>
                            <div class="tbl-row">
                                <div class="tbl-cell"><i class="fa fa-envelope"></i></div>
                                <div class="tbl-cell">
                                    <p class="paragraph-medium paragraph-white">hello@yourdomain.com</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 footer-block">
                    <div class="footer-ttl"><p>Newsletter</p></div>
                    <div class="footer-container footer-c">
                        <div class="footer-subscribe">
                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label form-input">
                                <input class="mdl-textfield__input" type="text" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$" id="subscribe-email">
                                <label class="mdl-textfield__label" for="subscribe-email">Your Email</label>
                                <span class="mdl-textfield__error">Please Enter Valid Email!</span>
                            </div>
                            <div class="footer-subscribe-button">
                                <button class="mdl-button mdl-js-button mdl-js-ripple-effect button button-primary">Submit</button>
                            </div>
                        </div>
                        <ul class="social-list social-list-colored footer-social">
                            <li>
                                <a href="#" target="_blank" id="footer-facebook" class="fa fa-facebook"></a>
                                <span class="mdl-tooltip mdl-tooltip--top" data-mdl-for="footer-facebook">Facebook</span>
                            </li>
                            <li>
                                <a href="#" target="_blank" id="footer-twitter" class="fa fa-twitter"></a>
                                <span class="mdl-tooltip mdl-tooltip--top" data-mdl-for="footer-twitter">Twitter</span>
                            </li>
                            <li>
                                <a href="#" target="_blank" id="footer-google" class="fa fa-google"></a>
                                <span class="mdl-tooltip mdl-tooltip--top" data-mdl-for="footer-google">Google</span>
                            </li>
                            <li>
                                <a href="#" target="_blank" id="footer-instagram" class="fa fa-instagram"></a>
                                <span class="mdl-tooltip mdl-tooltip--top" data-mdl-for="footer-instagram">Instagram</span>
                            </li>
                            <li>
                                <a href="#" target="_blank" id="footer-youtube" class="fa fa-youtube"></a>
                                <span class="mdl-tooltip mdl-tooltip--top" data-mdl-for="footer-youtube">Youtube</span>
                            </li>
                            <li>
                                <a href="#" target="_blank" id="footer-linkedin" class="fa fa-linkedin"></a>
                                <span class="mdl-tooltip mdl-tooltip--top" data-mdl-for="footer-linkedin">Linkedin</span>
                            </li>
                            <li>
                                <a href="#" target="_blank" id="footer-flickr" class="fa fa-flickr"></a>
                                <span class="mdl-tooltip mdl-tooltip--top" data-mdl-for="footer-flickr">Flickr</span>
                            </li>
                            <li>
                                <a href="#" target="_blank" id="footer-rss" class="fa fa-rss"></a>
                                <span class="mdl-tooltip mdl-tooltip--top" data-mdl-for="footer-rss">Rss</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div id="copyright">
            <div class="layer-stretch">
                <div class="paragraph-medium paragraph-white">2017 © Pepdev ALL RIGHTS RESERVED.</div>
            </div>
        </div>
    </footer>
</div>


<!-- **********Included Scripts*********** -->

<!-- Jquery Library 2.1 JavaScript-->
<script src="js/jquery-2.1.4.min.js"></script>
<!-- Popper JavaScript-->
<script src="js/popper.min.js"></script>
<!-- Bootstrap Core JavaScript-->
<script src="js/bootstrap.min.js"></script>
<!-- Material Design Lite JavaScript-->
<script src="js/material.min.js"></script>
<!-- Material Select Field Script -->
<script src="js/mdl-selectfield.min.js"></script>
<!-- Flexslider Plugin JavaScript-->
<script src="js/jquery.flexslider.min.js"></script>
<!-- Owl Carousel Plugin JavaScript-->
<script src="js/owl.carousel.min.js"></script>
<!-- Scrolltofixed Plugin JavaScript-->
<script src="js/jquery-scrolltofixed.min.js"></script>
<!-- Magnific Popup Plugin JavaScript-->
<script src="js/jquery.magnific-popup.min.js"></script>
<!-- WayPoint Plugin JavaScript-->
<script src="js/jquery.waypoints.min.js"></script>
<!-- CounterUp Plugin JavaScript-->
<script src="js/jquery.counterup.js"></script>
<!-- SmoothScroll Plugin JavaScript-->
<script src="js/smoothscroll.min.js"></script>
<script src="js/custom.js"></script>
<script src="API/modele.articles.js"></script>
<script src="API/modele.users.js"></script>
<script src="API/modele.comments.js"></script>
<script>
    let app = new Vue({
        el: '#vue-app',
        data: {
            displayBlock: 'articles',
            user: '',
            articles: articles,
            article: '',
            comments: comments,
            users: users,
            searchString: '',
            form_login_password: '',
            form_login_login: '',
            form_register_login: '',
            form_register_password: '',
            form_register_name: '',
            form_register_firstname: '',
            form_register_addres: '',
            form_commentaire_text: '',
            defaultUser: {
                "id_user": 0,
                "name": "Visiteur",
                "firstName": "",
                "addres": "",
                "login": "",
                "password": "",
                "picture": "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"
            },
            articlesByPage: 5,
            activePage: 1,
            alerts: [],
        },
        computed:{
            userConnected(){
                return this.user !== '';
            },
            filteredArticles: function(){
                let localArticles = articles,
                    searchString = this.searchString;
                if(searchString === ''){
                    // Pagination mode
                    let pagedArticles = [];
                    for(let i = 0; i<this.articlesByPage; i++){
                        let index = (this.activePage - 1) * this.articlesByPage + i;
                        if(this.articles.length > index){
                            pagedArticles.push(this.articles[index]);
                        }
                    }
                    return pagedArticles;
                }
                else{
                    searchString = searchString.trim().toLowerCase().replace('é', 'e').replace('è', 'e').replace('ê', 'e').replace('à', 'a');
                    localArticles = localArticles.filter(function(article){
                        if(article.title.toLowerCase().replace('é', 'e').replace('è', 'e').replace('ê', 'e').replace('à', 'a').indexOf(searchString) !== -1){
                            return article;
                        }
                        else if(article.category.toLowerCase().replace('é', 'e').replace('è', 'e').replace('ê', 'e').replace('à', 'a').indexOf(searchString) !== -1){
                            return article;
                        }
                        else if(article.author.toLowerCase().replace('é', 'e').replace('è', 'e').replace('ê', 'e').replace('à', 'a').indexOf(searchString) !== -1){
                            return article;
                        }
                    });
                }

                // Return an array with the filtered data.
                return localArticles;
            },
            recentArticles(){
                let myArticles = this.articles;
                myArticles = myArticles.sort(function(a, b){return new Date(b.datePost) - new Date(a.datePost)});
                let myNArticles = [];
                //limit 5 articles
                for(let i = 0; i < 5; i++){
                    myNArticles.push(myArticles[i]);
                }
                return myNArticles;
            },
            groupCountCategoryArticles() {
                let listCategory = [];
                for(let i = 0; i < this.articles.length; i++){
                    listCategory.push(this.articles[i].category);
                }
                listCategory.sort();
                return listCategory.filter((v,i,a) => a.indexOf(v) === i);
            }
        },
        methods:{
            display(block){
                this.displayBlock = block;
            },
            userLogin(){
                //ToDo API login
                for(let i = 0; i<this.users.length; i++){
                    if(this.form_login_password === this.users[i].password && this.form_login_login === this.users[i].login){
                        this.user = this.users[i];
                        this.popAlert('alert-success', 'Bonjour ' + this.user.name + ', vous êtes maintenant connecté.');
                    }
                }

                if(this.user === ''){
                    this.popAlert('alert-danger', 'La connexion a échoué.');
                }

                this.displayBlock = 'articles';
            },
            userLogout() {
                this.user = '';
                this.displayBlock = 'articles';
                this.popAlert('alert-success', 'Vous êtes maintenant déconnecté.');
            },
            userRegister(){
                let newUser = {
                    "id_user": this.getUID(),
                    "name": this.form_register_name,
                    "firstName": this.form_register_firstname,
                    "addres": this.form_register_addres,
                    "login": this.form_register_login,
                    "password": this.form_register_password,
                    "picture": "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"
                };
                this.users.push(newUser);
                //Todo API POST USER
                let rslt = true;
                if(rslt){
                    this.popAlert('alert-success', 'Vous venez de vous enregistrer !');
                }
                else{
                    this.popAlert('alert-danger', 'Une erreur est survenue.');
                }

                //Reset form fields
                this.form_register_name = '';
                this.form_register_firstname = '';
                this.form_register_addres = '';
                this.form_register_login = '';
                this.form_register_password = '';
            },
            dateToStr(date){
                let myDate = new Date(date);
                let dateOption = {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                };
                return myDate.toLocaleDateString("fr-FR", dateOption);
            },
            selectArticle(oneArticle){
                this.displayBlock = 'article';
                this.article = oneArticle;
            },
            getPictureByUserId(id){
                let rslt = '';
                let found = false;
                for(let i = 0; i<this.users.length; i++){
                    if(id === this.users[i].id_user){
                        rslt = "data:image/jpeg;base64," + this.users[i].picture;
                        found = true;
                    }
                }
                if(found){
                    return rslt;
                }
                else{
                    return "data:image/jpeg;base64,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";
                }
            },
            submitComment(article){
                let newComment = '';
                // Check if an user is connected
                if(this.user === ''){
                    newComment = {
                        "id_comment" : this.getUID(),
                        "id_author" : this.defaultUser.id_user,
                        "name_author" : this.defaultUser.name,
                        "contains" : this.form_commentaire_text,
                        "picture" : this.defaultUser.picture,
                        "dateComment" : this.dateToStr(new Date()),
                        "id_article" : this.article.id_article
                    }
                }
                else{
                    newComment = {
                        "id_comment" : this.getUID(),
                        "id_author" : this.user.id_user,
                        "name_author" : this.user.name + " " + this.user.firstName,
                        "contains" : this.form_commentaire_text,
                        "picture" : this.user.picture,
                        "dateComment" : this.dateToStr(new Date()),
                        "id_article" : article.id_article
                    }
                }

                this.comments.push(newComment);
                //ToDo API Ajout d'un commentaire
                let rslt = true;
                if(rslt){
                    this.popAlert('alert-success', 'Commentaire ajouté !');
                }
                else{
                    this.popAlert('alert-danger', 'Une erreur est survenue.');
                }
            },
            getUID(){
                function s4() {
                    return Math.floor((1 + Math.random()) * 0x10000)
                        .toString(16)
                        .substring(1);
                }
                return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
            },
            nbArticle(){
                return this.articles.length;
            },
            nbPage(){
                return Math.ceil(this.nbArticle()/this.articlesByPage);
            },
            setPageActive(number){
                this.activePage = number;
            },
            popAlert(type, content){
                let newAlert = {
                    type: type,
                    content: content
                };
                this.alerts.push(newAlert);
            },
            deleteArticle(article){
                //ToDo API deleteArticle
                let index = 0;
                for(let i = 0; i<this.articles.length; i++){
                    if(this.articles[i].id_article === article.id_article){
                        index = i;
                    }
                }
                this.articles.splice(index, 1);
                console.log('splice');
                this.popAlert('alert-success', 'Article supprimé !');
            },
            createArticle(article){
                //Todo API createArticle
                this.articles.push(article);
                this.popAlert('alert-success', 'Article créé !');
            },
            updateArticle(article){
                //Todo API updateArticle
                let index = 0;
                for(let i = 0; i<this.articles.length; i++){
                    if(this.articles[i].id_article === article.id_article){
                        index = i;
                    }
                }
                if(index !== 0){
                    this.articles.splice(index, 1, article);
                }
                this.popAlert('alert-success', 'Article modifié !');
            }
        }
    })
</script>
</body>
</html>
